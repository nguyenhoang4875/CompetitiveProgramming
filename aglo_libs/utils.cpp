// mod index 1
int modIdx1(int i, int n) {
    return ((i - 1) % n + n) % n + 1;
}
